# IDEF1X Модель - Дополнительная сущность

## Новая сущность: MaintenanceLog (Журнал технического обслуживания)

### Описание

Сущность **MaintenanceLog** предназначена для ведения журнала технического обслуживания и ремонта воздушных судов в летной школе. Это критически важная информация для обеспечения безопасности полетов и соблюдения авиационных норм.

### Назначение

1. **Отслеживание технического состояния** - ведение истории всех работ по обслуживанию каждого самолета
2. **Планирование ТО** - определение сроков следующего обслуживания
3. **Финансовый учет** - контроль затрат на техническое обслуживание
4. **Нормативное соответствие** - выполнение требований авиационных властей по документированию ТО
5. **Анализ надежности** - выявление часто возникающих проблем

### Атрибуты сущности

| № | Атрибут | Тип данных | Описание | Обязательность |
|---|---------|-----------|----------|----------------|
| 1 | **ID_Записи** | INTEGER | Уникальный идентификатор записи (PK) | Обязательное |
| 2 | **ID_Самолета** | INTEGER | Ссылка на самолет (FK) | Обязательное |
| 3 | **Дата_Обслуживания** | DATETIME | Дата проведения работ | Обязательное |
| 4 | **Тип_Обслуживания** | STRING | Тип ТО (плановое, внеплановое, ремонт) | Обязательное |
| 5 | **Описание_Работ** | STRING | Детальное описание выполненных работ | Обязательное |
| 6 | **Стоимость** | DECIMAL | Стоимость обслуживания | Обязательное |
| 7 | **Механик** | STRING | ФИО ответственного механика | Обязательное |
| 8 | **Примечания** | STRING | Дополнительные заметки | Необязательное |

**Всего атрибутов:** 8 (требовалось минимум 5) ✅

### Связи с другими сущностями

**Связь с Aircraft (Самолет):**
- Тип связи: Many-to-One (много записей обслуживания для одного самолета)
- Кардинальность: 1:N
- Внешний ключ: ID_Самолета
- Правило удаления: Restrict (нельзя удалить самолет, если есть записи обслуживания)

### Типичные значения

**Тип_Обслуживания:**
- "Плановое ТО 50 часов"
- "Плановое ТО 100 часов"
- "Плановое ТО 500 часов"
- "Внеплановый ремонт"
- "Замена деталей"
- "Капитальный ремонт"
- "Модернизация"

**Описание_Работ (примеры):**
- "Замена масла в двигателе, проверка свечей зажигания, осмотр лопастей винта"
- "Регламентные работы по 100-часовому циклу: проверка систем управления, тормозной системы, электрооборудования"
- "Ремонт: замена стартера, регулировка карбюратора"

### Бизнес-правила

1. **Обязательность записи:** Каждое техническое обслуживание должно быть задокументировано
2. **Временная последовательность:** Дата обслуживания не может быть в будущем
3. **Финансовый контроль:** Стоимость должна быть больше нуля
4. **Ответственность:** Каждая запись должна содержать ФИО ответственного механика
5. **Сохранность истории:** Записи не могут быть удалены (только архивированы)

### Интеграция с автоматизированной системой

**Функции АИС:**

1. **Автоматическое напоминание:** Система уведомляет о приближении срока планового ТО на основе налета часов
2. **Отчеты:** Автоматическая генерация отчетов по техническому обслуживанию для авиационных властей
3. **Анализ затрат:** Статистика расходов на обслуживание по каждому самолету
4. **История:** Быстрый доступ к полной истории обслуживания любого самолета
5. **Планирование:** Учет графика ТО при составлении расписания полетов

### Реализация в коде

**Файл модели:** `MigrationService/Models/MaintenanceLog.cs`

**Основные свойства C# класса:**
```csharp
public class MaintenanceLog
{
    public int MaintenanceLogID { get; set; }
    public int AircraftID { get; set; }
    public DateTime MaintenanceDate { get; set; }
    public string MaintenanceType { get; set; }
    public string Description { get; set; }
    public decimal? Cost { get; set; }
    public string MechanicName { get; set; }
    public string? Notes { get; set; }
    public virtual Aircraft Aircraft { get; set; }
}
```

**Таблица БД:** `MaintenanceLogs`

**Интеграция с DbContext:**
- Добавлен DbSet<MaintenanceLog>
- Настроена связь с Aircraft через внешний ключ
- Установлено правило OnDelete(DeleteBehavior.Restrict)

### Диаграмма связей

```
Aircraft (1) ----< (N) MaintenanceLog
   |                      |
   | AircraftID           | MaintenanceLogID (PK)
   | TailNumber           | AircraftID (FK)
   | Model                | MaintenanceDate
   | Type                 | MaintenanceType
   | Year                 | Description
   | TotalHours           | Cost
   | Status               | MechanicName
                          | Notes
```

### Преимущества добавления этой сущности

1. **Безопасность полетов:** Полный контроль технического состояния всех самолетов
2. **Соответствие нормам:** Выполнение требований авиационных властей
3. **Планирование:** Возможность планировать расписание с учетом графика ТО
4. **Финансовый контроль:** Отслеживание затрат на содержание парка самолетов
5. **Анализ:** Выявление проблемных самолетов, требующих повышенного внимания
6. **История:** Сохранение полной истории обслуживания для каждого воздушного судна

### Требования для курсовой работы

✅ **Минимум 5 атрибутов:** Создано 8 атрибутов
✅ **Связь с существующей сущностью:** Связана с Aircraft
✅ **Реализация в коде:** Создан C# класс и обновлен DbContext
✅ **Интеграция в IDEF1X модель:** Добавлена в файл 1ver.ercmdl
✅ **Обоснование:** Сущность логически соответствует предметной области

## Заключение

Сущность MaintenanceLog является важным дополнением к информационной модели летной школы, обеспечивая полный контроль над техническим обслуживанием авиационной техники и соответствие требованиям безопасности полетов.
